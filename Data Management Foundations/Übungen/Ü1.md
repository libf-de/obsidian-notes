## a)
Gesucht sind Name und Einwohnerzahl aller Städte in absteigender Reihenfolge ihrer Einwohnerzahl.
```SQL
SELECT NAME, 
	POPULATION 
FROM CITY 
ORDER BY POPULATION DESC
```
> [!info]- Output
> <table cellspacing="0" cellpadding="0"> <tbody> <tr> <th>NAME</th> <th>POPULATION</th> </tr><tr> <td>Seoul</td><td>10229262</td></tr><tr> <td>Mumbai</td><td>9925891</td></tr><tr> <td>Karachi</td><td>9863000</td></tr><tr> <td>Mexico City</td><td>9815795</td></tr><tr> <td>Sao Paulo</td><td>9811776</td></tr><tr> <td>Moscow</td><td>8717000</td></tr><tr> <td>Jakarta</td><td>8259266</td></tr><tr> <td>Tokyo</td><td>7843000</td></tr><tr> <td>Shanghai</td><td>7830000</td></tr><tr> <td>Istanbul</td><td>7615500</td></tr><tr> <td>New York</td><td>7380906</td></tr><tr> <td>New Delhi</td><td>7206704</td></tr><tr> <td>Beijing</td><td>7000000</td></tr><tr> <td>London</td><td>6967500</td></tr><tr><td colspan="2" style="text-align: center">...</td></tr></tbody></table>

## b)
Ermitteln Sie alle Städte (Name), die sowohl an einem Fluss als auch an einem See liegen.
```SQL
SELECT CITY
FROM LOCATED
WHERE RIVER IS NOT NULL 
	AND LAKE IS NOT NULL
```
> [!info]- Output
> <table cellspacing="0" cellpadding="0"><tbody><tr><th>CITY</th></tr><tr><td>Vanersborg</td></tr><tr><td>Karlstad</td></tr></tbody></table>

## c)
Gesucht sind Name und Einwohnerzahl alle deutschen Städte in absteigender Reihenfolge ihrer Einwohnerzahl.
```SQL
SELECT NAME, 
	POPULATION
FROM CITY 
WHERE COUNTRY = 'D'
```
> [!info]- Output
> <table cellspacing="0" cellpadding="0"> <tbody> <tr> <th>NAME</th> <th>POPULATION</th> </tr><tr> <td>Berlin</td><td>3472009</td></tr><tr> <td>Hamburg</td><td>1705872</td></tr><tr> <td>Hannover</td><td>525763</td></tr><tr> <td>Munich</td><td>1244676</td></tr><tr> <td>Mannheim</td><td>316223</td></tr><tr> <td>Saarbruecken</td><td>183945</td></tr><tr> <td>Muenchen</td><td>1290079</td></tr><tr> <td>Bremen</td><td>549182</td></tr><tr><td colspan="2" style="text-align: center">...</td></tr></tbody></table>


## d)
Ermitteln Sie alle Sprachen (Name), die in Ländern Europas gesprochen werden.
```SQL
SELECT DISTINCT NAME 
FROM LANGUAGE 
WHERE COUNTRY IN 
	(SELECT COUNTRY FROM ENCOMPASSES WHERE CONTINENT = 'Europe')
```
> [!info]- Output
> <table cellspacing="0" cellpadding="0"> <tbody> <tr> <th>NAME</th> </tr><tr> <td>Slovenian</td></tr><tr> <td>Serbo-Croatian</td></tr><tr> <td>Turkish</td></tr><tr> <td>German</td></tr><tr> <td>Dutch</td></tr><tr> <td>Castilian Spanish</td></tr><tr> <td>Galician</td></tr><tr style="text-align: center;"> <td>...</td></tr></tbody></table>

## e)
Ermitteln Sie alle Sprachen (Name), die in Ländern der EU gesprochen werden, und in wie vielen Ländern (der EU) sie gesprochen werden, absteigend geordnet nach Anzahl der Länder.
```SQL
SELECT NAME, 
	COUNT(COUNTRY) 
FROM LANGUAGE 
WHERE COUNTRY IN 
	(SELECT COUNTRY FROM IS_MEMBER WHERE ORGANIZATION  = 'EU' AND TYPE = 'member')
GROUP BY NAME
ORDER BY COUNT(COUNTRY) DESC
```
> [!info]- Output
> <table cellspacing="0" cellpadding="0"><tbody><tr><th>NAME</th><th>COUNT(COUNTRY)</th></tr><tr><td>German</td><td>3</td></tr><tr><td>Dutch</td><td>2</td></tr><tr><td>French</td><td>2</td></tr><tr><td>Swedish</td><td>2</td></tr><tr><td>Basque</td><td>1</td></tr><tr><td>Castilian Spanish</td><td>1</td></tr><tr><td>Catalan</td><td>1</td></tr><tr><td>Finnish</td><td>1</td></tr><tr><td>Galician</td><td>1</td></tr><tr><td>Lapp- Russian-speaking</td><td>1</td></tr><tr><td>Portuguese</td><td>1</td></tr></tbody></table>


## f)
Gesucht sind Name, Einwohnerzahl und Name des Landes aller Hauptstädte, in denen mehr als 30% der Bevölkerung des Landes leben, in absteigender Reihenfolge ihrer Einwohnerzahl.
```SQL
SELECT CITY.NAME, 
	CITY.POPULATION, 
	COUNTRY.NAME "LAND" 
FROM CITY AS CITY 
JOIN COUNTRY ON CITY.COUNTRY = COUNTRY.CODE 
WHERE CITY.NAME = COUNTRY.CAPITAL 
	AND CITY.POPULATION > (COUNTRY.POPULATION*0.3)
```
> [!info]- Output
> <table cellspacing="0" cellpadding="0"><tbody><tr><th>NAME</th><th>POPULATION</th><th>LAND</th></tr><tr><td>Vaduz</td><td>27714</td><td>Liechtenstein</td></tr><tr><td>Riga</td><td>900000</td><td>Latvia</td></tr><tr><td>Tallinn</td><td>478000</td><td>Estonia</td></tr><tr><td>Vatican City</td><td>392</td><td>Holy See</td></tr><tr><td>Reykjavik</td><td>84000</td><td>Iceland</td></tr><tr><td>Yerevan</td><td>1200000</td><td>Armenia</td></tr><tr><td>Doha</td><td>217294</td><td>Qatar</td></tr><tr><td>Singapore</td><td>2558000</td><td>Singapore</td></tr><tr><td>Saint Johns</td><td>36000</td><td>Antigua and Barbuda</td></tr><tr><td>Nassau</td><td>140000</td><td>Bahamas</td></tr><tr><td>Saint Georges</td><td>30000</td><td>Grenada</td></tr><tr><td>Basseterre</td><td>14700</td><td>Saint Kitts and Nevis</td></tr><tr><td>Castries</td><td>49000</td><td>Saint Lucia</td></tr><tr><td>Koror</td><td>7685</td><td>Palau</td></tr><tr><td>Santiago</td><td>4318000</td><td>Chile</td></tr><tr><td>Montevideo</td><td>1247000</td><td>Uruguay</td></tr><tr><td>Paramaribo</td><td>150000</td><td>Suriname</td></tr></tbody></table>


## g)
Bestimmen Sie alle Länder (Name) mit mindestens einem über 4.000 m hohen Berg.
```SQL
SELECT NAME
FROM COUNTRY
WHERE CODE IN 
	(SELECT DISTINCT COUNTRY FROM GEO_MOUNTAIN WHERE MOUNTAIN IN 
		(SELECT NAME FROM MOUNTAIN WHERE HEIGHT > 4000)
	)
```
> [!info]- Output
> <table cellspacing="0" cellpadding="0"><tbody><tr><th>NAME</th></tr><tr><td>Kyrgyzstan</td></tr><tr><td>Bolivia</td></tr><tr><td>United States</td></tr><tr><td>Kazakstan</td></tr><tr><td>France</td></tr><tr><td>Iran</td></tr><tr><td>Cameroon</td></tr><tr><td>Kenya</td></tr><tr><td>Argentina</td></tr><tr><td>Russia</td></tr><tr><td>Morocco</td></tr><tr><td>Peru</td></tr><tr><td>China</td></tr><tr><td>Chile</td></tr><tr><td>Tajikistan</td></tr><tr><td>Ethiopia</td></tr><tr><td>Indonesia</td></tr><tr><td>Tanzania</td></tr><tr><td>Georgia</td></tr><tr><td>Ecuador</td></tr><tr><td>Mexico</td></tr></tbody></table>


## h)
Gesucht sind alle Länder (Name) mit mindestens einer Stadt, welche mehr Einwohner hat als die Hauptstadt des Landes.
```SQL
SELECT DISTINCT COUNTRY.NAME "LANDNAME", 
	CAPITAL.NAME "HAUPTSTADT" FROM COUNTRY 
JOIN CITY AS CAPITAL ON CAPITAL.NAME = COUNTRY.CAPITAL
JOIN CITY AS GCITY ON GCITY.NAME = (SELECT CCITY.NAME FROM CITY AS CCITY WHERE CCITY.COUNTRY = COUNTRY.CODE ORDER BY CCITY.POPULATION DESC LIMIT 1)
WHERE CAPITAL.POPULATION < GCITY.POPULATION 
	AND GCITY.NAME IS NOT CAPITAL.NAME 
ORDER BY COUNTRY.NAME
```

## i)
Ermitteln Sie die Namen aller Länder mit Millionenstädten sowie der jeweiligen Gesamtpopulation aller Millionenstädte eines Landes in Reihenfolge dieser Gesamtpopulation.
```SQL
SELECT 
	(SELECT NAME FROM COUNTRY WHERE CODE = CITY.COUNTRY) "LAND", 
	SUM(CITY.POPULATION) 
FROM CITY 
WHERE POPULATION > 1000000 
GROUP BY COUNTRY 
ORDER BY SUM(CITY.POPULATION) DESC
```

## j)
Gesucht sind alle Länder (Name), die an Deutschland grenzen, sowie deren gesamte Grenzlänge.
```SQL
SELECT 
	(SELECT NAME FROM COUNTRY WHERE CODE = COUNTRY1) "Land1", 
	(SELECT NAME FROM COUNTRY WHERE CODE = COUNTRY2) "Land2", 
	SUM(LENGTH) 
FROM BORDERS 
WHERE COUNTRY1 = 'D' 
	OR COUNTRY2 = 'D' 
GROUP BY COUNTRY1,COUNTRY2
```

## k)
Ermitteln Sie die Namen aller Länder, deren Anteil an Einwohnern, welche in den Millionenstädten des Landes leben, größer als 30% ist, aufsteigend geordnet nach diesem Anteil.
```SQL
SELECT NAME, 
	( 
		CAST((SELECT SUM(CITY.POPULATION) FROM CITY WHERE CITY.POPULATION > 1000000 AND CITY.COUNTRY = COUNTRY.CODE) as float) 
		/ 
		CAST(COUNTRY.POPULATION as float) 
	) as RATIO 
FROM COUNTRY 
WHERE 
	(SELECT SUM(CITY.POPULATION) FROM CITY WHERE CITY.POPULATION > 1000000 AND CITY.COUNTRY = COUNTRY.CODE) > COUNTRY.POPULATION*0.3 
ORDER BY RATIO DESC
```

## l)
Gesucht sind alle Länder (Name), die mehr Seen als Berge haben, in aufsteigender Reihenfolge der Anzahl der Seen. Es sollen nur Länder berücksichtigt werden, in denen es sowohl Seen als auch Berge gibt.
```SQL
SELECT NAME, 
	(SELECT COUNT(*) FROM GEO_SEA WHERE GEO_SEA.COUNTRY = COUNTRY.CODE) AS SEACOUNT, 
	(SELECT COUNT(*) FROM GEO_MOUNTAIN WHERE GEO_MOUNTAIN.COUNTRY = COUNTRY.CODE) AS MOUNTAINCOUNT 
FROM COUNTRY 
WHERE (SELECT COUNT(*) FROM GEO_SEA WHERE GEO_SEA.COUNTRY = COUNTRY.CODE) > (SELECT COUNT(*) FROM GEO_MOUNTAIN WHERE GEO_MOUNTAIN.COUNTRY = COUNTRY.CODE) 
	AND (SELECT COUNT(*) FROM GEO_SEA WHERE GEO_SEA.COUNTRY = COUNTRY.CODE) > 0 
	AND (SELECT COUNT(*) FROM GEO_MOUNTAIN WHERE GEO_MOUNTAIN.COUNTRY = COUNTRY.CODE) > 0 
ORDER BY SEACOUNT
```

## m)
Bestimmen Sie alle Länder (Name), die mehr Nachbarstaaten als Deutschland haben.
```SQL
SELECT NAME, 
	(SELECT COUNT(*) FROM BORDERS WHERE BORDERS.COUNTRY1 = COUNTRY.CODE OR BORDERS.COUNTRY2 = COUNTRY.CODE) AS NEIGHBORCOUNT 
FROM COUNTRY
WHERE 
	(SELECT COUNT(*) FROM BORDERS WHERE BORDERS.COUNTRY1 = COUNTRY.CODE OR BORDERS.COUNTRY2 = COUNTRY.CODE) 
	> 
	(SELECT COUNT(*) FROM BORDERS WHERE BORDERS.COUNTRY1 = 'D' OR BORDERS.COUNTRY2 = 'D') 
ORDER BY NEIGHBORCOUNT DESC
```

## n)
Bestimmen Sie die Stadt mit der größten Einwohnerzahl und das Land, in dem sie liegt.
```SQL
SELECT CITY.NAME, 
	CITY.POPULATION, 
	(SELECT COUNTRY.NAME FROM COUNTRY WHERE COUNTRY.CODE = CITY.COUNTRY) AS COUNTRYNAME 
FROM CITY 
ORDER BY CITY.POPULATION DESC 
LIMIT 1
```